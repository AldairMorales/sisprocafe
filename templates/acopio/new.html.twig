{% extends 'base.html.twig' %}
{% import 'macro/breadcrumb.html.twig' as breadcrumb %}
{% import 'macro/action.html.twig' as action %}

{% set _title = 'Acopio' %}
{% set _main_title = 'Nuevo' %}
{% set _section =  'acopio_index'%}

{% block _breadcrumb %}
    {{ breadcrumb.show2(_title,_section,'Nuevo') }}
{% endblock %}

{% block _main %}
    {{ include('acopio/_form.html.twig') }}
{% endblock %}

{% block _main_tools %}
    {% include 'crud/_tools_ico.html.twig' %}
{% endblock %}

{% block _body_tools %}
    {% include 'crud/_new_links_ico.html.twig' with {'route_base':'acopio'} %}
{% endblock %}

{% block _body_tools_ico %}
    {% include 'crud/_new_links_tool.html.twig' with {'route_base': 'acopio'}  %}
{% endblock %}

{% block _main_footer %}
    {% include 'crud/_new_links.html.twig' with {'route_base':'acopio'} %}
{% endblock %}

{% block _stylesheets %}
{% endblock %}

{% block _javascripts %}
    <script src="{{ asset('js/select2.js') }}"></script>
    <script>
        jQuery(document).ready(function() {
            Select2();

            let $pesoBruto = $('#acopio_pesoBruto')
            let $cantidadTara = $('#acopio_cantidad')
            let $taraPorSaco = $('#acopio_taraPorSaco')
            let $taraDeSacos = $('#acopio_taraDeSacos')
            let $pesoQuintal = $('#acopio_pesoQuintales')
            let $pesoNeto = $('#acopio_pesoNeto')
            let $btnSave = document.getElementsByClassName('btn btn-warning')

            function calcularTara()
            {
                if($taraDeSacos.val()) {
                    let tara = parseFloat($cantidadTara.val()) * parseFloat($taraPorSaco.val());
                    $taraDeSacos.val(tara.toFixed(2));
                    console.log(tara);
                }

            }

            function calcularPesoNeto()
            {
                if($pesoBruto.val() && $taraDeSacos.val()) {
                    let merma = 0.25;
                    let neto = parseFloat($pesoBruto.val()) - parseFloat($taraDeSacos.val()) - merma;
                    neto = neto.toFixed(2);
                    $pesoNeto.val(neto);
                }
            }

            $(document).ready(function () {
                $(document).on('change', '#acopio_pesoNeto', function () {
                    let $this = $(this);
                    $pesoNeto.val($this.val());
                    calcularTara();
                    calcularPesoNeto();
                });
                $('#acopio_pesoNeto').trigger('change');
            })
        });
    </script>
{% endblock %}